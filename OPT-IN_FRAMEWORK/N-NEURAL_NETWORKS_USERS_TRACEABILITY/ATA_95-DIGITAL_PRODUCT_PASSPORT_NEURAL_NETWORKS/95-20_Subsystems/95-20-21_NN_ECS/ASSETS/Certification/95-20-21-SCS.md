# **95-20-21 — Software Code Standards (SCS)**

### ECS Neural Network Subsystem (NN_ECS)

**Document ID**: 95-20-21-SCS
**Version**: 1.0
**Status**: WORKING
**Certification Level**: DO-178C Level C
**Subsystem**: 95-20-21 NN_ECS
**Last Updated**: 2025-11-19

---

# **1. Purpose**

The purpose of the **Software Code Standards (SCS)** is to define:

* Mandatory coding practices
* Safety constraints
* Deterministic behaviour rules
* Prohibited patterns
* Naming conventions
* Resource constraints
* Comments & documentation expectations

for the ECS Neural Network subsystem (95-20-21 NN_ECS), ensuring:

* **Compliance with DO-178C DAL C**
* **Safe integration of neural network components**
* **Reviewability, traceability, testability, and auditability**
* Deterministic runtime behaviour
* Predictable resource use on IMA partitions
* Conformance with the SDS + SRS requirements

This SCS applies to:

* NN wrapper code
* Input validation code
* Output envelope functions
* Safety shell logic
* Logging/output pipelines
* ONNX runtime interface code
* Pre/post-processing code
* Data ingestion code

(Not applicable to training scripts, except for documentation rules.)

---

# **2. Applicable Documents**

| Doc              | Description                                 |
| ---------------- | ------------------------------------------- |
| SDP              | Software Development Plan                   |
| SRS              | Software Requirements Specification         |
| SDS              | Software Design Standards                   |
| SVP              | Software Verification Plan                  |
| PSAC             | Plan for Software Aspects of Certification  |
| SCMP             | Software Configuration Management Plan      |
| SQAP             | Software Quality Assurance Plan             |
| DO-178C          | Software Considerations in Airborne Systems |
| DO-330           | Tool Qualification                          |
| DO-331           | Model-Based Development                     |
| SC-AI            | EASA Special Condition for AI               |
| FAA AI Assurance | ML lifecycle & safety                       |

---

# **3. Coding Languages Allowed**

Only the following languages are permitted:

### **3.1 C/C++ (IMA partition integration)**

* For safety-shell logic
* For inference management
* For bounds checking
* For fallback logic
* For deterministic pipelines

### **3.2 Python (ground tools + reference implementations)**

Allowed only for:

* Training reference code
* Data processing
* CI validation tools
* Documentation generation
* ONNX inspection scripts

Python is **not permitted** in airborne software.

---

# **4. General Code Rules (DO-178C DAL C)**

### **4.1 Determinism**

All airborne code MUST be:

* Time-deterministic
* Resource-bounded
* No dynamic allocation after initialization
* No recursion
* No unbounded loops
* No randomness

### **4.2 Reviewability**

Code must be:

* Readable
* Maintainable
* Avoiding clever constructs
* Avoiding “magic numbers”
* Using standard control structures only

### **4.3 Traceability**

Each code file must contain:

* Component ID
* Model ID (if applicable)
* Requirement IDs (HLR/LLR)
* Document Control header
* Link to Model Card (if applicable)

Example header:

```c
/*
 * 95-20-21-A-101 Temperature Predictor Wrapper
 * Requirements: HLR-101, HLR-102, LLR-001, LLR-003, LLR-006
 * Model Card: ASSETS/Model_Cards/95-20-21-A-101.yaml
 * DO-178C DAL Level C
 * Generated with AI assistance (GitHub Copilot), prompted by Amedeo Pelliccia.
 */
```

---

# **5. Coding Standards for C/C++**

### **5.1 Prohibited Features**

The following are **prohibited**:

* Dynamic memory (malloc/new) after init
* Exceptions (C++ exceptions)
* RTTI
* Virtual inheritance
* Function pointers (unless safety reviewed)
* Threads
* Floating dynamic-size arrays
* Variadic functions
* Non-deterministic libraries

### **5.2 Allowed Features**

* Fixed-size arrays
* Struct-based data models
* Deterministic state machines
* Static memory allocation
* Lookup tables
* Pure functions
* Stack-only temporary variables

### **5.3 Naming Conventions**

Variables: `snake_case`
Types/structs: `CamelCase`
Global constants: `UPPER_CASE`
Functions: `verb_noun()`

Example:

```c
float validate_temperature(float input_temp);
```

### **5.4 Error Handling**

All errors must funnel into the unified fallback routine:

```c
trigger_fallback(FALLBACK_REASON_INPUT_INVALID);
```

---

# **6. Neural Network Wrapper Code Standards**

The wrapper is DAL-C and therefore must follow strict rules.

### **6.1 ONNX runtime interface**

Allowed:

* Preloaded session
* Preallocated input/output tensors
* Static shape checking
* Synchronous execution

Prohibited:

* Dynamic ONNX loading
* Dynamic tensor shapes
* Multi-threaded inference

### **6.2 Input Validation**

Input validation MUST occur before inference:

```c
if (!validate_inputs(input)) {
    trigger_fallback(FALLBACK_REASON_INVALID_INPUT);
    return SAFE_OUTPUT;
}
```

Validation includes:

* Range
* Type
* Timestamp freshness
* Sensor validity flags

### **6.3 Output Safety Envelope**

Output must be clipped:

```c
output[i] = clamp(output[i], MIN_SAFE_TEMP, MAX_SAFE_TEMP);
```

### **6.4 Confidence Filtering**

If `confidence < threshold`:

→ output suppressed
→ fallback triggered

### **6.5 Anomaly Detection**

If `anomaly_flag == true`:

→ fallback triggered

---

# **7. Logging & Recording Standards**

### **7.1 Mandatory fields**

Each inference cycle must log:

* Inputs
* Outputs
* Confidence
* Anomaly status
* Fallback transitions
* Execution time
* Model version → hash

### **7.2 Format**

* fixed-width binary
* timestamped
* compatible with ATA-31 recorder

---

# **8. Timing & Performance Standards**

### **8.1 Latency Budgets**

* Wrapper execution < **3 ms**
* NN inference < **10 ms**
* Jitter < **1 ms**

### **8.2 Checks**

Code must measure:

```c
start = get_time();
run_inference();
end = get_time();

if (end - start > MAX_INFERENCE_TIME_MS)
    trigger_fallback(FALLBACK_REASON_TIMEOUT);
```

---

# **9. Memory Management Standards**

### **9.1 Prohibited**

* malloc() after init
* realloc(), calloc()
* new/delete
* dynamic containers (std::vector, std::map, etc.)

### **9.2 Required**

All buffers must be allocated at initialization:

```c
static float input_tensor[24];
static float output_tensor[6];
static float confidence_tensor[6];
```

---

# **10. Safety Shell Standards**

Each NN must be enclosed in an envelope enforcing:

* shape consistency
* range checking
* confidence threshold
* fallback activation
* deterministic output generation

Safety shell must be **provably independent** of NN logic.

---

# **11. Python Code Standards (non-airborne)**

### **11.1 Allowed Use Cases**

* Reference models
* Training loops
* ONNX export
* Dataset generation
* Synthetic data tools
* CI tests
* Documentation helpers

### **11.2 Conventions**

* PEP-8
* Type hints mandatory
* Deterministic random seeds
* No side effects on import
* Functions < 80 LOC unless justified

---

# **12. Auto-Generated Code Standards**

AI-generated code (Copilot, ChatGPT) must:

* Be clearly marked with comment headers
* Be manually reviewed
* Be approved via Pull Request
* Be cross-linked in DPP lineage
* Have safety-critical portions manually validated

---

# **13. Testing Hooks & Instrumentation**

### **13.1 Mandatory Testing Interfaces**

Each module must expose:

* Self-test function
* Input validator test
* Safety envelope test
* Timing measurement API

### **13.2 Assertions**

Assertions prohibidas en runtime operacional.
Permitidas solo en test builds.

---

# **14. Code Review Standards**

### **14.1 Required reviewers**

* ML engineer
* Safety engineer
* Verification engineer
* Documentation/traceability gatekeeper

### **14.2 Checklist**

Checks include:

* SRS alignment
* LLR alignment
* SDS conformance
* DPP metadata
* Determinism
* Bounded memory
* Fallback logic
* Naming rules
* No prohibited features

---

# **15. Document Control**

* **Document ID**: 95-20-21-SCS
* **Version**: 1.0
* **Status**: WORKING
* **Author**: AMPEL360 Software Engineering Team
* **AI Assistance**: ChatGPT + GitHub Copilot
* **Prompted by**: *Amedeo Pelliccia*
* **Approval**: Pending Certification Authority

---

# ✔ Siguiente documento sugerido:

Puedo generar ahora:

### **SAS — Software Accomplishment Summary**


