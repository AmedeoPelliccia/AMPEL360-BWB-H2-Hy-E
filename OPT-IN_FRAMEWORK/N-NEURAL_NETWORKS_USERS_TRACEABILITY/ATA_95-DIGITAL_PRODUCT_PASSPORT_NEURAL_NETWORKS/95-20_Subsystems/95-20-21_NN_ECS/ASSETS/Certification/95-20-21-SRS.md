# **95-20-21 — Software Requirements Specification (SRS)**

### ECS Neural Network Subsystem (NN_ECS)

**Document ID**: 95-20-21-SRS
**Applies To**: Models A-101 → A-107
**Certification Target**: **DO-178C Level C**
**Version**: 1.0
**Status**: WORKING
**Last Updated**: 2025-11-19

---

# **1. Purpose**

The Software Requirements Specification (SRS) defines all **high-level and low-level software requirements** for the ECS Neural Network Subsystem (95-20-21 NN_ECS).

Requirements are defined to:

* Satisfy **DO-178C DAL C**
* Ensure safe integration of NN-based functions in ATA-21 (ECS)
* Support fallback, safety envelopes, and deterministic operation
* Satisfy **EASA SC-AI** & **FAA AI Assurance Framework**
* Maintain alignment with **ATA 95 DPP** governance
* Provide end-to-end **traceability** to Model Cards, Source Code, ONNX artefacts, datasets, and tests

Each requirement is:

* Numbered
* Testable
* Traceable
* Bounded
* Fully linked by CI scripts into `TRACE/95-20-21-TRACE.csv`

---

# **2. System Overview**

The subsystem includes the following NN modules:

| Model ID | Name                        | Function                             |
| -------- | --------------------------- | ------------------------------------ |
| A-101    | Cabin Temperature Predictor | Forecast 6-zone temp (5-min horizon) |
| A-102    | Air Quality Monitor         | CO₂/VOC/PM/Humidity classification   |
| A-103    | HVAC Optimizer              | Energy-optimal supervisory control   |
| A-104    | Pressure Control NN         | Predictive pressurization profile    |
| A-105    | Humidity Manager            | Humidity forecast & setpoint tuner   |
| A-107    | CO₂ Scrubbing Optimizer     | Scrubber efficiency optimisation     |

Each model has a Model Card in:
`ASSETS/Model_Cards/`

---

# **3. Definitions**

* **NN** — Neural Network
* **LLR** — Low-level requirement
* **HLR** — High-level requirement
* **ECS** — Environmental Control System (ATA-21)
* **DPP** — Digital Product Passport (ATA-95)
* **Runtime Wrapper** — deterministic DAL-C shell around the NN
* **Fallback Mode** — deterministic classical ECS logic

---

# **4. References**

* **PSAC** — 95-20-21-PSAC
* **SCMP** — 95-20-21-SCMP
* **SQAP** — 95-20-21-SQAP
* **SVP** — 95-20-21-SVP
* **SDP** — 95-20-21-SDP
* **Model Cards** — `ASSETS/Model_Cards/95-20-21-A-XXX_*.yaml`
* **Architecture** — A-001, A-003, A-005 diagrams
* **DO-178C, DO-330, DO-331, DO-333**
* **EASA SC-AI** & **FAA AI Assurance Framework**

---

# **5. System-Level Requirements (HLRs)**

*(Applies to NN subsystem as a whole)*

### **HLR-001 — ECS NN Advisory Role**

The ECS NN subsystem shall **not directly command actuators**.
It shall output **advisory setpoints**, validated by deterministic envelope logic before being forwarded to the classical ECS controller.

### **HLR-002 — Safe Output Bounds**

All NN outputs shall be constrained within **certified safety envelopes** defined by ATA-21 requirements (temperature, pressure, humidity, CO₂ flow, AQI thresholds).

### **HLR-003 — Deterministic Execution**

The inference pipeline shall execute **deterministically** with:

* Fixed execution time < **10 ms**
* Fixed tensor shapes
* No stochastic behaviour

### **HLR-004 — Confidence Monitoring**

Each NN shall provide a **confidence value**.
If confidence < threshold, output shall be suppressed and fallback logic activated.

### **HLR-005 — Fallback Activation**

For any error, anomaly, invalid data, or confidence drop:
The wrapper shall force ECS into **Classical ECS Fallback Mode**.

### **HLR-006 — Input Validation**

All inputs shall be validated for:

* Range
* Type
* Units
* Source integrity indicators
* Timestamp freshness

Invalid data shall result in fallback activation.

### **HLR-007 — Real-Time Requirements**

The subsystem shall support **10 Hz inference** for all NN components.

### **HLR-008 — Logging & Recording**

All inputs, outputs, confidences, anomalies, and fallback events shall be logged with timestamps for:

* ATA-31 Recording Systems
* Training data curation
* Certification review

### **HLR-009 — Traceability**

Each NN model shall include metadata to support:

* DPP lineage
* Dataset hashes
* Model hashes
* Training configuration references

### **HLR-010 — Error Handling**

The system shall detect and safely handle:

* Runtime errors
* NN load errors
* Shape mismatches
* Buffer overflows
* Memory/time exceedances

By entering fallback mode.

---

# **6. Functional Requirements (HLR per model)**

---

## **6.1 A-101 Cabin Temperature Predictor**

### **HLR-101 — Forecast Horizon**

Model shall predict cabin temperature for **6 zones, 5-minute horizon**.

### **HLR-102 — Accuracy Requirement**

Predictions shall be within **±0.5°C (95th percentile)**.

### **HLR-103 — Input Set**

Model shall use:

* Temp sensors (6 zones)
* External temperature
* Passenger count
* Flight phase
* Historical temp window
* Airflow rate
* HVAC power

### **HLR-104 — Output Format**

Output shall be:

* Float32[6] predicted temperature
* Float32[6] confidence values
* Boolean anomaly flag

---

## **6.2 A-102 Air Quality Monitor**

### **HLR-201 — AQI Classification**

Model shall classify air quality into **5 classes** (Excellent → Hazardous).

### **HLR-202 — Detection Requirements**

Shall detect anomalies in:

* CO₂
* VOC
* PM2.5/PM10
* Humidity

### **HLR-203 — False Positive Threshold**

False positives < **0.5%**.

---

## **6.3 A-103 HVAC Optimizer**

### **HLR-301 — Supervisory Role**

Optimizer shall output **setpoint advisories**, not direct actuator commands.

### **HLR-302 — Energy Efficiency**

Shall propose the energy-optimal HVAC settings within bounded envelopes.

### **HLR-303 — Multi-NN Integration**

Shall combine inputs from:

* A-101 forecasts
* A-102 AQI data
* A-105 humidity forecasts
* A-107 CO₂ scrubber efficiency

---

## **6.4 A-104 Pressure Control NN**

### **HLR-401 — Pressure Curve Compliance**

Shall predict cabin pressure trajectory consistent with ATA-21 pressurization rules.

### **HLR-402 — No Unsafe Cabin Rate**

Shall never output predictions implying unsafe cabin rate-of-change.

---

## **6.5 A-105 Humidity Manager**

### **HLR-501 — Humidity Forecast**

Shall forecast cabin humidity for multiple compartments at 5 min horizon.

### **HLR-502 — RH Envelope**

Shall maintain RH within ATA-21 limits.

---

## **6.6 A-107 CO₂ Scrubbing Optimizer**

### **HLR-601 — Scrubber Duty Optimization**

Shall compute optimal scrubber operation rate balancing:

* CO₂ removal
* Energy usage
* Component wear

---

# **7. Low-Level Requirements (LLRs)**

*(Applies to wrapper code + deterministic logic)*

### **LLR-001 — Input Range Check**

Every input shall pass a range validation according to model card definitions.

### **LLR-002 — Type and Shape Check**

Tensor shapes must match ONNX metadata exactly.

### **LLR-003 — Safety Envelope Clipping**

Wrapper shall clamp outputs to certified boundaries.

### **LLR-004 — Anomaly Detection Trigger**

If:

* Input out-of-distribution
* Confidence < threshold
* NN internal error
  Wrapper shall:
* Set anomaly flag
* Force fallback mode

### **LLR-005 — Timestamp Freshness**

Input data older than **250 ms** must be rejected.

### **LLR-006 — Deterministic Execution**

Wrapper must avoid:

* Threads
* Randomness
* Dynamic memory allocation

### **LLR-007 — Error Logging**

Any deviation must log:

* Error type
* Timestamp
* Inputs
* Fallback result

### **LLR-008 — NN Runtime Verification**

Wrapper shall verify:

* NN session loaded
* Correct Tensor names
* No missing nodes

---

# **8. Interface Requirements**

### **Inputs — Common Requirements**

All models receive:

| Signal          | Source             | Unit   |
| --------------- | ------------------ | ------ |
| Temperature     | ATA-21             | °C     |
| Humidity        | RH sensors         | %      |
| CO₂             | CO₂ sensors        | ppm    |
| VOC             | VOC sensor         | ppb    |
| PM2.5/PM10      | particulate sensor | µg/m³  |
| Airflow         | ECS Ventilation    | m³/min |
| Flight phase    | FMS                | enum   |
| Passenger count | CMS                | count  |

### **Outputs — Common Requirements**

All wrappers must output:

* Result vector
* Confidence value(s)
* Boolean anomaly flag

---

# **9. Safety Requirements**

### **SAF-001 — Unsafe Output Prevention**

Wrapper must ensure the NN can never command unsafe ECS behaviour.

### **SAF-002 — Fallback Mode**

Activated whenever:

* NN fails
* Low confidence
* Out-of-range inputs
* Timeout
* Inference > 10 ms

### **SAF-003 — Rate Limiting**

All setpoints must respect certified rate limits.

### **SAF-004 — Fault Propagation**

All faults shall be reported to:

* ECS Controller
* System Monitor
* ATA-31 recorder

---

# **10. Timing Requirements**

### **TIM-001 — Inference Deadline**

Inference must complete in < **10 ms**.

### **TIM-002 — 10 Hz Operation**

NN modules shall run at **0.1 s** intervals.

---

# **11. Reliability Requirements**

### **REL-001 — No Runtime Crashes**

NN runtime must not crash under normal or degraded conditions.

### **REL-002 — Memory Stability**

Memory usage < **50 MB**, variation < **±5%**.

---

# **12. Data Requirements**

### **DATA-001 — Dataset Integrity**

Training datasets must follow DO-200B principles.

### **DATA-002 — Dataset Lineage**

Dataset used for each model must be recorded in the Model Card.

### **DATA-003 — Synthetic Data Validation**

Synthetic data must be validated vs real data distributions.

---

# **13. Documentation Requirements**

All requirement IDs must trace to:

* Model Cards
* Code
* ONNX nodes
* Tests
* Evidence files
* DPP entries

---

# **14. Traceability**

All requirements appear in:

`TRACE/95-20-21-TRACE.csv`

With mapping:

```
HLR → LLR → Source Code → ONNX Model → Test Case → Verification Result → Evidence → Certification Bundle
```

---

# **15. Document Control**

* **Document ID**: 95-20-21-SRS
* **Version**: 1.0
* **Status**: WORKING
* **Author**: AMPEL360 ML Engineering Team
* **AI Assistance**: ChatGPT + GitHub Copilot
* **Prompted by**: *Amedeo Pelliccia*
* **Review Required**: Certification Authority

---
