{
  "asset_id": "02-60-03-A-001",
  "description": "Example S3 bucket policies for AMPEL360 object storage",
  "version": "1.0",
  "status": "DRAFT",
  "generated_by": "AI (GitHub Copilot), prompted by Amedeo Pelliccia",
  "last_updated": "2025-11-21",
  "note": "These are abstract, generic policies. Adapt to specific IAM and security requirements.",
  
  "bucket_policies": [
    {
      "bucket_name": "ampel360-prod-documents",
      "description": "Production EFB documents and manuals",
      "policy": {
        "Version": "2012-10-17",
        "Statement": [
          {
            "Sid": "AllowEFBReadAccess",
            "Effect": "Allow",
            "Principal": {
              "AWS": "arn:aws:iam::ACCOUNT_ID:role/EFBApplicationRole"
            },
            "Action": [
              "s3:GetObject",
              "s3:ListBucket"
            ],
            "Resource": [
              "arn:aws:s3:::ampel360-prod-documents",
              "arn:aws:s3:::ampel360-prod-documents/*"
            ],
            "Condition": {
              "IpAddress": {
                "aws:SourceIp": [
                  "10.0.0.0/8",
                  "172.16.0.0/12"
                ]
              }
            }
          },
          {
            "Sid": "AllowDocumentUpload",
            "Effect": "Allow",
            "Principal": {
              "AWS": "arn:aws:iam::ACCOUNT_ID:role/DocumentAdminRole"
            },
            "Action": [
              "s3:PutObject",
              "s3:PutObjectAcl"
            ],
            "Resource": "arn:aws:s3:::ampel360-prod-documents/*",
            "Condition": {
              "StringEquals": {
                "s3:x-amz-server-side-encryption": "AES256"
              }
            }
          },
          {
            "Sid": "DenyUnencryptedObjectUploads",
            "Effect": "Deny",
            "Principal": "*",
            "Action": "s3:PutObject",
            "Resource": "arn:aws:s3:::ampel360-prod-documents/*",
            "Condition": {
              "StringNotEquals": {
                "s3:x-amz-server-side-encryption": "AES256"
              }
            }
          }
        ]
      }
    },
    {
      "bucket_name": "ampel360-prod-backups",
      "description": "Production database and system backups",
      "policy": {
        "Version": "2012-10-17",
        "Statement": [
          {
            "Sid": "AllowBackupSystemWriteAccess",
            "Effect": "Allow",
            "Principal": {
              "AWS": "arn:aws:iam::ACCOUNT_ID:role/BackupServiceRole"
            },
            "Action": [
              "s3:PutObject",
              "s3:GetObject",
              "s3:DeleteObject"
            ],
            "Resource": "arn:aws:s3:::ampel360-prod-backups/*"
          },
          {
            "Sid": "AllowBackupListAccess",
            "Effect": "Allow",
            "Principal": {
              "AWS": "arn:aws:iam::ACCOUNT_ID:role/BackupServiceRole"
            },
            "Action": "s3:ListBucket",
            "Resource": "arn:aws:s3:::ampel360-prod-backups"
          },
          {
            "Sid": "DenyPublicAccess",
            "Effect": "Deny",
            "Principal": "*",
            "Action": "s3:*",
            "Resource": [
              "arn:aws:s3:::ampel360-prod-backups",
              "arn:aws:s3:::ampel360-prod-backups/*"
            ],
            "Condition": {
              "StringNotEquals": {
                "aws:PrincipalAccount": "ACCOUNT_ID"
              }
            }
          }
        ]
      },
      "additional_settings": {
        "versioning": "Enabled",
        "object_lock": "Governance mode, 90 days retention",
        "lifecycle_policy": "Transition to Glacier after 30 days"
      }
    },
    {
      "bucket_name": "ampel360-prod-logs",
      "description": "Application and system logs",
      "policy": {
        "Version": "2012-10-17",
        "Statement": [
          {
            "Sid": "AllowLogShipping",
            "Effect": "Allow",
            "Principal": {
              "AWS": [
                "arn:aws:iam::ACCOUNT_ID:role/ApplicationLogRole",
                "arn:aws:iam::ACCOUNT_ID:role/SystemLogRole"
              ]
            },
            "Action": "s3:PutObject",
            "Resource": "arn:aws:s3:::ampel360-prod-logs/*"
          },
          {
            "Sid": "AllowSecurityTeamReadAccess",
            "Effect": "Allow",
            "Principal": {
              "AWS": "arn:aws:iam::ACCOUNT_ID:role/SecurityAuditRole"
            },
            "Action": [
              "s3:GetObject",
              "s3:ListBucket"
            ],
            "Resource": [
              "arn:aws:s3:::ampel360-prod-logs",
              "arn:aws:s3:::ampel360-prod-logs/*"
            ]
          }
        ]
      },
      "additional_settings": {
        "versioning": "Disabled",
        "lifecycle_policy": "Delete after 365 days"
      }
    },
    {
      "bucket_name": "ampel360-prod-ml-models",
      "description": "ML model artifacts and datasets",
      "policy": {
        "Version": "2012-10-17",
        "Statement": [
          {
            "Sid": "AllowMLOpsAccess",
            "Effect": "Allow",
            "Principal": {
              "AWS": "arn:aws:iam::ACCOUNT_ID:role/MLOpsRole"
            },
            "Action": [
              "s3:GetObject",
              "s3:PutObject",
              "s3:ListBucket"
            ],
            "Resource": [
              "arn:aws:s3:::ampel360-prod-ml-models",
              "arn:aws:s3:::ampel360-prod-ml-models/*"
            ]
          },
          {
            "Sid": "AllowMLInferenceReadOnly",
            "Effect": "Allow",
            "Principal": {
              "AWS": "arn:aws:iam::ACCOUNT_ID:role/MLInferenceRole"
            },
            "Action": [
              "s3:GetObject",
              "s3:ListBucket"
            ],
            "Resource": [
              "arn:aws:s3:::ampel360-prod-ml-models",
              "arn:aws:s3:::ampel360-prod-ml-models/models/*"
            ]
          }
        ]
      },
      "additional_settings": {
        "versioning": "Enabled",
        "lifecycle_policy": "Retain all versions, transition to IA after 90 days",
        "dpp_integration": "Blockchain hash anchoring for model artifacts"
      }
    }
  ],
  
  "common_security_requirements": {
    "encryption_at_rest": "AES-256",
    "encryption_in_transit": "TLS 1.3",
    "access_logging": "Enabled - ship to centralized log bucket",
    "mfa_delete": "Enabled for production buckets with versioning",
    "public_access_block": "All public access blocked by default"
  },
  
  "references": {
    "internal": [
      "02-60-03 Object Storage README",
      "02-60-00-003 Data Governance Policy",
      "02-60-12 Storage Security"
    ],
    "external": [
      "AWS S3 Bucket Policy Examples: https://docs.aws.amazon.com/AmazonS3/latest/userguide/example-bucket-policies.html",
      "S3 Security Best Practices: https://docs.aws.amazon.com/AmazonS3/latest/userguide/security-best-practices.html"
    ]
  },
  
  "document_control": {
    "generated_by": "AI (GitHub Copilot)",
    "prompted_by": "Amedeo Pelliccia",
    "status": "DRAFT",
    "human_approver": "[to be completed]",
    "repository": "AMPEL360-BWB-H2-Hy-E",
    "last_ai_update": "2025-11-21"
  }
}
