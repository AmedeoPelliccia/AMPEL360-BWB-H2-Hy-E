; ============================================================
; CFD Cruise M0.82 Setup â€“ AMPEL360 BWB H2 Hy-E Q100 INTEGRA
; Analysis ID: 02-11-00-AERO-001
; Condition: Mach 0.82, FL410, ISA
; ============================================================

/file/read-case "YOUR_MESH_FILE.msh.h5"

; ---------------------------
; 1. General settings
; ---------------------------
/define/general/units
si
yes

/define/models/energy yes
/define/models/viscous k-omega-sst yes

; Optional: enable compressibility if not already
/define/models/solver
pressure-based yes
steady? yes

; ---------------------------
; 2. Materials & air properties
; ---------------------------
/define/materials/change-create air
ideal-gas
yes
; Cp, mu, k, etc. can be left default for ISA if using ideal-gas + Sutherland

; ---------------------------
; 3. Cell zone & reference values
; ---------------------------
; Set reference values (based on baseline geometry)

; Reference area S = 845.0 m^2
; Reference length (MAC, placeholder) = 5.0 m  ; <-- adjust to your MAC
; Reference density/velocity from ISA @ FL410

/define/reference-values
area 845.
length 5.
velocity 242.
mach-number yes
mach-number 0.82
yes

; ---------------------------
; 4. Boundary conditions
; ---------------------------
; Assumes boundaries named: inlet, outlet, farfield, wall-aircraft, symmetry

/define/boundary-conditions/pressure-far-field inlet
yes
mach-number 0.82
static-pressure 18750
temperature 216.65
yes

/define/boundary-conditions/pressure-far-field farfield
yes
mach-number 0.82
static-pressure 18750
temperature 216.65
yes

/define/boundary-conditions/pressure-outlet outlet
yes
; set backflow conditions
backflow-total-temperature 216.65
backflow-total-pressure 18750
yes

/define/boundary-conditions/wall wall-aircraft
yes
shear-condition no-slip
thermal-condition adiabatic
yes

; Symmetry plane (if present)
/define/boundary-conditions/symmetry symmetry
yes

; ---------------------------
; 5. Solution methods
; ---------------------------
/solve/set/p-v-coupling 24
/solve/set/discretization-scheme pressure 14
/solve/set/discretization-scheme momentum 1
/solve/set/discretization-scheme turbulent-kinetic-energy 1
/solve/set/discretization-scheme specific-dissipation-rate 1
/solve/set/under-relaxation-factors
pressure 0.3
momentum 0.7
turbulent-kinetic-energy 0.8
specific-dissipation-rate 0.8
yes

; ---------------------------
; 6. Monitors
; ---------------------------
; Lift, drag, moment on aircraft wall

/report/force-surface-setup
force-monitor yes
"wall-aircraft"
lift-direction 0 1 0
drag-direction 1 0 0
moment-center 0 0 0
yes

/solve/monitors/lift-coefficient-monitor yes
/solve/monitors/drag-coefficient-monitor yes
/solve/monitors/moment-coefficient-monitor yes

/solve/monitors/residual
convergence-criteria 1e-5
print? yes
plot? yes
yes

; ---------------------------
; 7. Initialization & run
; ---------------------------
/solve/initialize/initialize-flow
hybrid-initialization
yes

; First coarse convergence
/solve/iterate 1000

; Optional: refine if needed (replace region with your named adaption)
/adapt/gradient/mach-number yes
0.05
0.95
yes
/adapt/mark
/adapt/execute

/solve/iterate 1000

; ---------------------------
; 8. Write case & data
; ---------------------------
/file/write-case-data "CFD_Cruise_M082_converged.cas.h5"

; ---------------------------
; 9. Post-processing exports (Cp, Mach, etc.)
; ---------------------------
; Example: write surface data on aircraft for Cp & Mach

/file/export/ascii "CFD_Cruise_M082_surface_aircraft.dat" yes
"wall-aircraft"
"pressure-coefficient"
"mach-number"
()
yes

; end of journal
